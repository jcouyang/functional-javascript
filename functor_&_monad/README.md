# Functor & Monad
### Functor
Functor æ˜¯ å¯ä»¥è¢« map over çš„ç±»å‹. ä»€ä¹ˆå« map over...

æ¯”å¦‚ list å°±å¯ä»¥è¯´æ˜¯å¯ä»¥è¢«map over... é‚£ä¹ˆæ˜¯ä¸æ˜¯å¯æšä¸¾ç±»å‹?

ä¸æ˜¯çš„, æ¥çœ‹çœ‹ Haskell ä¸­å¦‚ä½•è§£é‡Š(å…¶å®æ‰€æœ‰å‡½æ•°å¼çš„æ¦‚å¿µå¯èƒ½ç”¨ haskell æ˜¯æœ€èƒ½è¯´æ˜é—®é¢˜çš„äº†).

```haskell
ghci > :t fmap
fmap :: (a -> b) -> fa -> f b
```

`fmap` åˆæ˜¯ä»€ä¹ˆä¸œè¥¿, fmap æ˜¯ map over Functor çš„å‡½æ•°. è¿™ä¸ªå‡½æ•°åªå¹²ä¸€ä¸ªäº‹æƒ…, å¯èƒ½é€šè¿‡å‰é¢è§£é‡Šçš„ä¸€ç‚¹ç‚¹ HaskellåŠŸå¤«,ä½ å¯èƒ½èƒ½ç¿»è¯‘`(a -> b) -> fa -> f b`äº†æŠŠ. ç»™å®šä¸€ä¸ªä»`a` åˆ°` b` çš„æ˜ å°„å‡½æ•°, å†ç»™å®šä¸€ä¸ª a çš„ Functor, è¿”å›ä¸€ä¸ª b çš„ Functor.

è™½ç„¶ä¸ªä¸ªå­—éƒ½è®¤è¯†, ä½†æ€ä¹ˆå°±ä¸çŸ¥é“å•¥æ„æ€.

å¦‚æœæˆ‘å†è¯´ä¸€ä¸ªæ–°è¯, ä½ æ˜¯ä¸æ˜¯ä¼šç–¯æ‰äº†-- Lift.

å¥½å§, æŠŠä»–ä»¬éƒ½ä¸²èµ·æ¥, ä½ å°±æ˜ç™½äº†.
1. å¹³å¸¸æˆ‘ä»¬å¯ä»¥æŠŠ`a`åˆ°`b` çš„æ˜ å°„å¯ä»¥å«åš map, æ˜ å°„çš„æ–¹å¼å°±æ˜¯å‡½æ•°äº†.
2. é‚£ä¹ˆç±»ä¼¼çš„å¯¹äºå‡½æ•°æˆ–è€…å…¶ä»–å¯ä»¥åšè¿™ç§ map æ“ä½œçš„ç±»å‹æˆ–ä¸€ç§è®¡ç®—æ–¹å¼, å«åš Functor.
3. è€Œè¿™ç§ map å°±å«åš fmap, ç»™å®š a é›†åˆåˆ° b é›†åˆçš„æ˜ å°„æ–¹å¼(ä¹Ÿå°±æ˜¯ä¸€ä¸ªå‡½æ•°), å°±èƒ½æ‰¾åˆ° å¯¹ a çš„ä¸€ç§è®¡ç®—(computation, ä»»ä½•å¯å˜æ¢çš„ç±»å‹, è¿™å°±æ˜¯ Functor) çš„å˜æ¢ -- å¯¹ b çš„å¯¹åº”è®¡ç®—æ–¹å¼.
4. å¦‚æœè¯¥è®¡ç®—æ˜¯ä¸€ä¸ªå‡½æ•°, é‚£ä¹ˆè¿™ä¸ªæ“ä½œå«åš lifting. éå¸¸å½¢è±¡çš„, æ ¹æ® a åˆ° b çš„æ˜ å°„ lift(ä¸¾) åˆ°å¦ä¸€ä¸ªå±‚é¢ä¸Š.

![](http://learnyouahaskell-zh-tw.csie.org/img/lifter.png)

è™½ç„¶ lifting å¾ˆå½¢è±¡, ä½†æ˜¯è¿˜æ˜¯è¶Šè¯´è¶ŠæŠ½è±¡äº†, æ¥ä¸¾ä¸ªæ —å­.
### ä¸¾ä¸ªæ —å­ğŸŒ°
> **note** æ³¨æ„æˆ‘ä»¬è¿˜æ²¡æœ‰å®ç° Functor, å› æ­¤ä¸‹é¢çš„æ —å­è¿˜ä¸èƒ½è¿è¡Œåœ¨ä½ çš„ console.

å‰é¢è¯´äº†, Functor å¯ä»¥æ˜¯æ•°ç»„, å› ä¸ºæ•°ç»„å¯ä»¥è¢« map over
```js
var plus1 = n => n+1;
fmap(plus1, [2, 4, 6, 8])// => [3,5,7,9]
```
è¿™é‡Œ,æ•°ç»„ Array å°±æ˜¯ Functor ç±»å‹, è€Œ fmap æŠŠ 2 -> 3 çš„æ˜ å°„æ–¹å¼å¯¹ Array [2,4,6,8] è¿›è¡Œäº†å˜æ¢, å¾—åˆ° [3,5,7,9]. è¿™è·Ÿæ•°ç»„çš„ map æ–¹æ³•ä¸€æ ·, æ¯”è¾ƒå¥½ç†è§£.

å†è¯•è¯•æ¢ä¸€ç§ Functor ç±»å‹, è¯•è¯•å‡½æ•°
```js
var times2 = m => m*2;
fmap(plus1, times2) // => function(){}
fmap(plus1, times2)(3) // => 7 (3*2+1)
```
çœ‹åˆ° fmap è¿”å›çš„æ˜¯ä¸€ä¸ªå‡½æ•°, å› ä¸ºä½  map over çš„æ˜¯ä¸€ä¸ªå‡½æ•°` times2`. è¿˜è®°å¾— `(a -> b) -> fa -> f b`çš„å…¬å¼ä¹ˆ, å› ä¸ºç°åœ¨çš„ Functor ä¸º Function ç±»å‹, å‡½æ•°ç±»å‹å¯ä»¥ç†è§£ä¸º`x->`, å› æ­¤æˆ‘ä»¬å¯ä»¥å°†è¯¥å…¬å¼æ›¿æ¢ä¸º
```
(a -> b) -> (x -> a) -> (x -> b)
```

å†ç”¨æˆ‘ä»¬å…·ä½“çš„å‡½æ•° plus1 æ›¿æ¢è¿›å»
```
(n->n+1) -> (x->n) -> (x -> n+1)
```
ä¹Ÿå°±æ˜¯è¯´, times2 åƒ x è¿”å›ä»»ä½• nçš„è¯, è¯¥ fmap lift å‡ºæ¥çš„å‡½æ•°ä¼šè¿”å› n+1.

è¿™ä¸å°±æ˜¯å‡½æ•°ç»„åˆå— `plus1(times2(3))`

Functor è¿˜å¯ä»¥æ˜¯ Monad...

### Functor in JavaScript
é¦–å…ˆ, å®ç° Functor ç±»å‹å®šä¹‰.
```js
 Functor = function(type, defs) {
        var oldTypes = types;
        types = function(obj) {
            if (type.prototype.isPrototypeOf(obj)) {
                return defs;
            }
            return oldTypes(obj);
        }
};
```

tobe continue...
